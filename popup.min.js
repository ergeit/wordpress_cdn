jQuery(function(t) {
    popupTemplate = {
        toast: function(t) {
            var o = t.type
              , n = t.icon
              , e = t.text;
            return '<section class="toast ' + o + " " + t.display + '" id="toast"><div class="toast_body">' + (n && "text" !== o ? "" + ("icon-loading" === n ? '<section class="icon"><svg class="circular" viewBox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="3" stroke-miterlimit="10"/></svg></section>' : '<section class="icon"><i class="modia ' + n + '"></i></section>') + "" : "") + "" + (e && "icon" !== o ? '<section class="text"><p>' + e + "</p></section>" : "") + "</div></section>"
        },
        modal: function(t) {
            var o = t.title
              , n = t.content
              , e = t.showCancel
              , a = t.btnText
              , s = t.id
              , i = void 0 === s ? "modal" : s;
            return '<section class="modal-box" data-lib="popup" data-popup-action="layerClose" data-layer="' + i + '" id="' + i + '"><section class="modal"><p class="title">' + o + '</p><section class="content"><p>' + n + '</p></section><section class="options-btns"><a href="javascript:;" data-callback="success" class="yes">' + a[0] + "</a>" + (e ? '<a href="javascript:;" data-callback="fail" class="close">' + a[1] + "</a>" : "") + "</section></section></section>"
        },
        customModal: function(t) {
            return '<section class="custom-modal-box" data-lib="popup" data-popup-action="layerClose" data-layer="customModal" id="customModal"><section class="modal"><section class="close-modal" data-popup-action="customModalClose"><i class="modia icon-close"></i></section>' + t + "</section></section>"
        }
    },
    customModalTemplate = {
        AlipayQrcode: function(t) {
            return '<section class="popup-wppay-qrcode alipay"><section class="pay-body"><h1 class="active">支付宝扫码支付' + t.price + '元</h1><div class="qr-code"><img src="' + t.code + '"class="img"alt=""></div><p class="account">' + t.desc + '</p></section><div class="tab-list"><p class="m-alipay"><a class="btn btn-primary" target="_blank"href="' + t.payurl + '">手机点击支付</a></p><p class="m-alipay-desc">手机支付完成，请返回当前页面刷新</p></div><p class="desc">' + t.payasb + '</p></section>'
        },
        WeixinpayQrcode: function(t) {
            return '<section class="popup-wppay-qrcode weixinpay"><section class="pay-body"><h1 class="active">微信扫码支付' + t.price + '元</h1><div class="qr-code"><img src="' + t.code + '"class="img"alt=""></div><p class="account">' + t.desc + '</p></section><p class="desc">' + t.payasb + '</p></section>'
        },
        PayMethod: function(t) {
            return '\n     <div class="pay-button-box"> '+t.html+' </div> \n '
        },
        
        Popup: function(t) {
            return '\n     <section class="popup-wppay-html">\n    ' + t.html + "   </section>\n "
        },
        
        Bigger: function(t) {
            return '\n    <section class="sign-popup" style=" padding: 1px; "> '+ t.html +' </section>    \n'
        }
    },
    customModalFunc = {
        addEvent: function() {
            var o = this;
            t(popup.element.customModal).on("click", "*[data-custom-action]", function(n) {
                var e = t(this).data("custom-action");
                o[e](t(this), n)
            })
        },
        removeEvent: function() {
            t(popup.element.customModal).off("click", "*[data-custom-action]")
        }
    },
    window.popup = {
        element: {
            body: "body",
            head: "head",
            toast: "#toast",
            modal: "#modal",
            customModal: "#customModal",
            scrollBodyStyle: "#scrollBodyStyle"
        },
        addEvent: function() {
            var o = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "body"
              , n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null
              , e = this
              , a = null !== n ? '*[data-popup-action="' + n + '"]' : "*[data-popup-action]";
            t(this.element[o]).on("click", a, function(o) {
                var n = t(this).data("popup-action");
                e[n](t(this), o)
            })
        },
        removeEvent: function() {
            var o = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "body"
              , n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null
              , e = null !== n ? '*[data-popup-action="' + n + '"]' : "*[data-popup-action]";
            t(this.element[o]).off("click", e)
        },
        showToast: function() {
            var o = this
              , n = arguments
              , e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}
              , a = e.type
              , s = void 0 === a ? "icon" : a
              , i = e.icon
              , c = void 0 === i ? "icon-loading" : i
              , l = e.text
              , d = void 0 === l ? "加载中..." : l
              , p = e.display
              , m = void 0 === p ? "fs" : p
              , u = e.el
              , r = void 0 === u ? "" : u
              , h = e.time
              , f = void 0 === h ? 1500 : h
              , v = e.callback;
            t(this.element.body).find(this.element.toast).length <= 0 ? ("el" === m ? (r = "string" == typeof r ? t(r) : r,
            r.append(popupTemplate.toast({
                type: s,
                icon: c,
                text: d,
                display: m
            }))) : t(this.element.body).append(popupTemplate.toast({
                type: s,
                icon: c,
                text: d,
                display: m
            })),
            t(this.element.toast).animate({
                opacity: 1
            }, 300),
            this.toastTimer = setTimeout(function() {
                t(o.element.toast).animate({
                    opacity: 0
                }, 300, function() {
                    t(o.element.toast).remove(),
                    "function" == typeof v && v()
                })
            }, f)) : this.hideToast(function() {
                o.showToast.call(o, n[0])
            })
        },
        hideToast: function(o) {
            var n = this;
            t(this.element.toast).animate({
                opacity: 0
            }, 300, function() {
                t(n.element.toast).remove(),
                clearTimeout(n.toastTimer),
                n.toastTimer = null,
                "function" == typeof o && o()
            })
        },
        showModal: function() {
            var o = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}
              , n = o.title
              , e = void 0 === n ? "提示" : n
              , a = o.content
              , s = void 0 === a ? "" : a
              , i = o.showCancel
              , c = void 0 === i || i
              , l = o.btnText
              , d = void 0 === l ? ["确定", "取消"] : l
              , p = (o.multiple,
            o.layerClose)
              , m = void 0 !== p && p
              , u = (o.success,
            o.fail,
            arguments)
              , r = this
              , h = t(this.element.body).find(this.element.modal).length
              , f = "modal_" + h;
            t(this.element.body).find("#" + f).length <= 0 && (utils.disabledScroll(),
            t(this.element.body).append(popupTemplate.modal({
                title: e,
                content: s,
                showCancel: c,
                btnText: d,
                id: f
            })),
            t("#" + f).on("click", "*[data-callback]", function() {
                var o = t(this).data("callback");
                u.length > 0 && u[0] && "function" == typeof u[0][o] && u[0][o] && u[0][o](f)
            }),
            m && t("#" + f).on("click", function(o) {
                r.layerClose(t(this), o)
            }))
        },
        showCustomModal: function(o) {
            var n = o.template
              , e = void 0 === n ? "" : n
              , a = o.data
              , s = void 0 === a ? {} : a
              , i = o.callback
              , c = o.layerClose
              , l = void 0 !== c && c
              , d = this;
            t(this.element.body).find(this.element.customModal).length <= 0 && (t(this.element.body).append(popupTemplate.customModal(customModalTemplate[e](s))),
            this.addEvent("body", "customModalClose"),
            customModalFunc.addEvent(),
            l && t(this.element.customModal).on("click", function(o) {
                d.layerClose(t(this), o)
            }),
            t(this.element.customModal).find("*[data-custom-submit]").length > 0 && t(this.element.customModal).on("click", "*[data-custom-submit]", function() {
                var o = {};
                t(d.element.customModal).find("*[name]").each(function() {
                    var n = t(this).attr("name");
                    o[n] = t(this).val() || ""
                }),
                "function" == typeof i && i(t(this), o)
            }))
        },
        hideModal: function(o) {
            t("#" + o).remove(),
            this.commonHide()
        },
        customModalClose: function(t) {
            t.parents("" + this.element.customModal).remove(),
            this.commonHide()
        },
        layerClose: function(o, n) {
            var e = n.target
              , a = o.data("layer");
            e.id && e.id === a && (t("#" + a).off("click").remove(),
            this.commonHide())
        },
        commonHide: function() {
            0 >= t(this.element.body).find("*[data-lib]").length && this.removeEvent(),
            t(this.element.body).off("click", '*[data-popup-action="customModalClose"]'),
            customModalFunc.removeEvent(),
            t(this.element.customModal).off("click", "*[data-custom-submit]")
        }
    }
});
